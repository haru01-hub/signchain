(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{392:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t);var n=r(7437),o=r(2265),a=r(9376),i=r(3519);r(1551);var s=r(4335),d=r(9274);function c(e){return/^[\w-.]+@[\w-]+\.[a-zA-Z]{2,}$/.test(e)}function l(e){return e.length>=8&&/[!@#$%^&*]/.test(e)}t.default=()=>{let[e,t]=(0,o.useState)(""),[r,u]=(0,o.useState)(""),[f,p]=(0,o.useState)(""),[h,m]=(0,o.useState)({}),y=(0,a.useRouter)(),[g,w]=(0,o.useState)(!1),[v,b]=(0,o.useState)(!1),x=c(e)&&l(r),j=async t=>{if(t&&t.preventDefault(),!x){p("입력값을 다시 확인하세요.");return}p(""),w(!0);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),o=await t.json();if(t.ok)localStorage.setItem("email",await (0,d.hH)(e)),o.userId&&localStorage.setItem("userId",await (0,d.hH)(o.userId)),o.redirectTo&&(o.redirectTo.startsWith("/otp/verify")?window.location.href=o.redirectTo:p("잘못된 인증 흐름입니다. 다시 시도해 주세요."));else{var n;(null===(n=o.message)||void 0===n?void 0:n.includes("인증서가 만료"))?b(!0):p(o.message||"로그인 실패")}}catch(e){p("서버 오류가 발생했습니다.")}finally{w(!1)}},S=e=>{"Enter"===e.key&&j(e)};return(0,n.jsxs)("div",{className:"card",style:{maxWidth:400,margin:"auto",padding:32},children:[(0,n.jsx)("h1",{style:{marginBottom:24},children:"로그인"}),f&&(0,n.jsx)("p",{style:{color:"red",marginBottom:16},children:f}),g&&(0,n.jsx)(i.Z,{}),(0,n.jsxs)("form",{onSubmit:j,style:{display:"flex",flexDirection:"column",gap:18},children:[(0,n.jsx)("input",{type:"email",name:"email",placeholder:"이메일",value:e,onChange:e=>{t(e.target.value),m(e=>({...e,email:!0})),p("")},onKeyDown:S,style:{padding:10,borderRadius:4,marginBottom:6,border:h.email&&!c(e)?"1.5px solid red":"1px solid #ddd"}}),h.email&&!c(e)&&(0,n.jsx)("div",{style:{color:"red",fontSize:13,marginBottom:8},children:"이메일 형식이 올바르지 않습니다."}),(0,n.jsx)("input",{type:"password",name:"password",placeholder:"비밀번호 (8자 이상, 특수문자 포함)",value:r,onChange:e=>{u(e.target.value),m(e=>({...e,password:!0})),p("")},onKeyDown:S,style:{padding:10,borderRadius:4,marginBottom:6,border:h.password&&!l(r)?"1.5px solid red":"1px solid #ddd"}}),h.password&&!l(r)&&(0,n.jsx)("div",{style:{color:"red",fontSize:13,marginBottom:8},children:"비밀번호는 8자 이상, 특수문자 포함이어야 합니다."}),(0,n.jsx)("button",{type:"submit",style:{padding:"12px 0",borderRadius:4,backgroundColor:x?"#2483bf":"#b3c6ff",color:"white",border:"none",cursor:x?"pointer":"not-allowed",fontWeight:600,marginTop:16,fontSize:17},disabled:!x,children:"로그인"})]}),(0,n.jsxs)("div",{style:{marginTop:32,color:"#555",fontSize:15,textAlign:"center"},children:["계정이 없으신가요?"," ",(0,n.jsx)("a",{href:"/register",style:{color:"#003cff",textDecoration:"underline"},children:"회원가입"})," ","하거나 로그인해주세요."]}),v&&(0,n.jsx)(s.Z,{message:"인증서가 만료되었습니다. 재발급이 필요합니다.",onConfirm:()=>{b(!1),y.push("/register")},onCancel:()=>{b(!1),y.push("/register")},confirmLabel:"확인",cancelLabel:"닫기"})]})}},4335:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(7437);function o(e){let{message:t,onConfirm:r,onCancel:o,integrityMsg:a="",children:i,confirmLabel:s="확인",cancelLabel:d="취소"}=e;return(0,n.jsx)("div",{className:"confirm-modal-backdrop",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:32,minWidth:320,boxShadow:"0 2px 16px #0003"},onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{style:{marginBottom:18},children:[(0,n.jsx)("b",{children:t}),i]}),(0,n.jsx)("div",{style:{display:"flex",gap:12,marginBottom:10,justifyContent:"center"},children:(0,n.jsx)("button",{onClick:r,style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontWeight:500},children:s})}),a&&(0,n.jsx)("div",{style:{color:a.includes("완료")?"green":"red",fontWeight:600},children:a})]})})}r(2265)},3519:function(e,t,r){"use strict";var n=r(7437);r(2265),r(1551),t.Z=()=>(0,n.jsx)("div",{className:"spinner-overlay",children:(0,n.jsx)("div",{className:"spinner"})})},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},9274:function(e,t,r){"use strict";let n;r.d(t,{LJ:function(){return c},bd:function(){return i},hH:function(){return u},jz:function(){return d},oj:function(){return s},vm:function(){return f}});var o=r(2957).lW,a=r(257);async function i(e,t){let r=new TextEncoder,n=await window.crypto.subtle.importKey("raw",r.encode(e),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r.encode(t),iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function s(e,t){var r;if(!(null===(r=window.crypto)||void 0===r?void 0:r.subtle))throw Error("이 브라우저는 WebCrypto를 지원하지 않습니다.");let n=new TextEncoder,o=window.crypto.getRandomValues(new Uint8Array(12)),a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},t,n.encode(e));return{iv:btoa(String.fromCharCode(...o)),data:btoa(String.fromCharCode(...new Uint8Array(a)))}}async function d(e,t){var r;if(!(null===(r=window.crypto)||void 0===r?void 0:r.subtle))throw Error("이 브라우저는 WebCrypto를 지원하지 않습니다.");let n=new TextDecoder,o=Uint8Array.from(atob(e.iv),e=>e.charCodeAt(0)),a=Uint8Array.from(atob(e.data),e=>e.charCodeAt(0)),i=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},t,a);return n.decode(i)}function c(e){if(!n)throw Error("Node.js crypto not available");let t=o.from(a.env.EMAIL_AES_KEY,"hex"),[r,i]=e.split(":"),s=o.from(r,"hex"),d=n.createDecipheriv("aes-256-cbc",t,s);return d.update(i,"hex","utf8")+d.final("utf8")}async function l(){return i("5012145a3c04312f81ce8b38c90d875f7de96b868f94f451cd6d6709a92d7c23","38f74cb399659a9016a080d65395986f")}async function u(e){let t=await l(),{iv:r,data:n}=await s(e,t);return JSON.stringify({iv:r,data:n})}async function f(e){try{console.log("[decryptLocal] 입력값:",e);let t=await l(),r=JSON.parse(e);console.log("[decryptLocal] 파싱된 iv:",r.iv),console.log("[decryptLocal] 파싱된 data:",r.data);let n=await d({iv:r.iv,data:r.data},t);return console.log("[decryptLocal] 복호화 결과:",n),n}catch(e){throw console.error("[decryptLocal] 복호화 중 에러:",e),e}}},1551:function(){}},function(e){e.O(0,[63,244,971,117,744],function(){return e(e.s=392)}),_N_E=e.O()}]);