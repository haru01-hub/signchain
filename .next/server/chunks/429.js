"use strict";exports.id=429,exports.ids=[429],exports.modules={20752:(e,t)=>{var r=function(e,t){return t||(t={}),e.split("").forEach(function(e,r){e in t||(t[e]=r)}),t},a={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};a.charmap=r(a.alphabet,a.charmap);var o={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};function i(e){if(this.buf=[],this.shift=8,this.carry=0,e){switch(e.type){case"rfc4648":this.charmap=t.rfc4648.charmap;break;case"crockford":this.charmap=t.crockford.charmap;break;default:throw Error("invalid type")}e.charmap&&(this.charmap=e.charmap)}}function n(e){if(this.buf="",this.shift=3,this.carry=0,e){switch(e.type){case"rfc4648":this.alphabet=t.rfc4648.alphabet;break;case"crockford":this.alphabet=t.crockford.alphabet;break;default:throw Error("invalid type")}e.alphabet?this.alphabet=e.alphabet:e.lc&&(this.alphabet=this.alphabet.toLowerCase())}}o.charmap=r(o.alphabet,o.charmap),i.prototype.charmap=a.charmap,i.prototype.write=function(e){var t=this.charmap,r=this.buf,a=this.shift,o=this.carry;return e.toUpperCase().split("").forEach(function(e){if("="!=e){var i=255&t[e];(a-=5)>0?o|=i<<a:a<0?(r.push(o|i>>-a),a+=8,o=i<<a&255):(r.push(o|i),a=8,o=0)}}),this.shift=a,this.carry=o,this},i.prototype.finalize=function(e){return e&&this.write(e),8!==this.shift&&0!==this.carry&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf},n.prototype.alphabet=a.alphabet,n.prototype.write=function(e){var t,r,a,o=this.shift,i=this.carry;for(a=0;a<e.length;a++)t=i|(r=e[a])>>o,this.buf+=this.alphabet[31&t],o>5&&(o-=5,t=r>>o,this.buf+=this.alphabet[31&t]),i=r<<(o=5-o),o=8-o;return this.shift=o,this.carry=i,this},n.prototype.finalize=function(e){return e&&this.write(e),3!==this.shift&&(this.buf+=this.alphabet[31&this.carry],this.shift=3,this.carry=0),this.buf},t.encode=function(e,t){return new n(t).finalize(e)},t.decode=function(e,t){return new i(t).finalize(e)},t.Decoder=i,t.Encoder=n,t.charmap=r,t.crockford=o,t.rfc4648=a},12304:(e,t,r)=>{var a=r(20752),o=a.Decoder.prototype.finalize;a.Decoder.prototype.finalize=function(e){return new Buffer(o.call(this,e))},e.exports=a},10429:(e,t,r)=>{var a=r(12304),o=r(84770),i=r(17360),n=r(21764);t.digest=function(e){var t,r=e.secret,i=e.counter,n=e.encoding||"ascii",s=(e.algorithm||"sha1").toLowerCase();null!=e.key&&(console.warn("Speakeasy - Deprecation Notice - Specifying the secret using `key` is no longer supported. Use `secret` instead."),r=e.key),Buffer.isBuffer(r)||(r="base32"===n?a.decode(r):new Buffer(r,n));var c=new Buffer(8),h=i;for(t=0;t<8;t++)c[7-t]=255&h,h>>=8;var p=o.createHmac(s,r);return p.update(c),p.digest()},t.hotp=function(e){var r=(null!=e.digits?e.digits:e.length)||6;null!=e.length&&console.warn("Speakeasy - Deprecation Notice - Specifying token digits using `length` is no longer supported. Use `digits` instead.");var a=e.digest||t.digest(e),o=15&a[a.length-1],i=(127&a[o])<<24|(255&a[o+1])<<16|(255&a[o+2])<<8|255&a[o+3];return(i=Array(r+1).join("0")+i.toString(10)).substr(-r)},t.counter=t.hotp,t.hotp.verifyDelta=function(e){var r,a=String((e=Object.create(e)).token),o=parseInt(e.digits,10)||6,i=parseInt(e.window,10)||0,n=parseInt(e.counter,10)||0;if(!(a.length!==o||isNaN(a=parseInt(a,10)))){for(r=n;r<=n+i;++r)if(e.counter=r,parseInt(t.hotp(e),10)===a)return{delta:r-n}}},t.hotp.verify=function(e){return null!=t.hotp.verifyDelta(e)},t._counter=function(e){var t=e.step||30,r=null!=e.time?1e3*e.time:Date.now(),a=(null!=e.epoch?1e3*e.epoch:1e3*e.initial_time)||0;return null!=e.initial_time&&console.warn("Speakeasy - Deprecation Notice - Specifying the epoch using `initial_time` is no longer supported. Use `epoch` instead."),Math.floor((r-a)/t/1e3)},t.totp=function(e){return null==(e=Object.create(e)).counter&&(e.counter=t._counter(e)),this.hotp(e)},t.time=t.totp,t.totp.verifyDelta=function(e){var r=parseInt((e=Object.create(e)).window,10)||0;null==e.counter&&(e.counter=t._counter(e)),e.counter-=r,e.window+=r;var a=t.hotp.verifyDelta(e);return a&&(a.delta-=r),a},t.totp.verify=function(e){return null!=t.totp.verifyDelta(e)},t.generateSecret=function(e){e||(e={});var r=e.length||32,o=encodeURIComponent(e.name||"SecretKey"),i=e.qr_codes||!1,n=e.google_auth_qr||!1,s=null==e.otpauth_url||e.otpauth_url,c=!0;void 0!==e.symbols&&!1===e.symbols&&(c=!1);var h=this.generateSecretASCII(r,c),p={};return p.ascii=h,p.hex=Buffer(h,"ascii").toString("hex"),p.base32=a.encode(Buffer(h)).toString().replace(/=/g,""),i&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() QR codes are deprecated and no longer supported. Please use your own QR code implementation."),p.qr_code_ascii="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.ascii),p.qr_code_hex="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.hex),p.qr_code_base32="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.base32)),s&&(p.otpauth_url=t.otpauthURL({secret:p.ascii,label:o})),n&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() Google Auth QR code is deprecated and no longer supported. Please use your own QR code implementation."),p.google_auth_qr="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(t.otpauthURL({secret:p.base32,label:o}))),p},t.generate_key=n.deprecate(function(e){return t.generateSecret(e)},"Speakeasy - Deprecation Notice - `generate_key()` is depreciated, please use `generateSecret()` instead."),t.generateSecretASCII=function(e,t){var r=o.randomBytes(e||32),a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";t&&(a+="!@#$%^&*()<>?/[]{},.:;");for(var i="",n=0,s=r.length;n<s;n++)i+=a[Math.floor(r[n]/255*(a.length-1))];return i},t.generate_key_ascii=n.deprecate(function(e,r){return t.generateSecretASCII(e,r)},"Speakeasy - Deprecation Notice - `generate_key_ascii()` is depreciated, please use `generateSecretASCII()` instead."),t.otpauthURL=function(e){var t=e.secret,r=e.label,o=e.issuer,n=(e.type||"totp").toLowerCase(),s=e.counter,c=e.algorithm,h=e.digits,p=e.period,l=e.encoding||"ascii";switch(n){case"totp":case"hotp":break;default:throw Error("Speakeasy - otpauthURL - Invalid type `"+n+"`; must be `hotp` or `totp`")}if(!t)throw Error("Speakeasy - otpauthURL - Missing secret");if(!r)throw Error("Speakeasy - otpauthURL - Missing label");if("hotp"===n&&null==s)throw Error("Speakeasy - otpauthURL - Missing counter value for HOTP");"base32"!==l&&(t=new Buffer(t,l)),Buffer.isBuffer(t)&&(t=a.encode(t));var u={secret:t};if(o&&(u.issuer=o),null!=c){switch(c.toUpperCase()){case"SHA1":case"SHA256":case"SHA512":break;default:console.warn("Speakeasy - otpauthURL - Warning - Algorithm generally should be SHA1, SHA256, or SHA512")}u.algorithm=c.toUpperCase()}if(null!=h){if(isNaN(h))throw Error("Speakeasy - otpauthURL - Invalid digits `"+h+"`");switch(parseInt(h,10)){case 6:case 8:break;default:console.warn("Speakeasy - otpauthURL - Warning - Digits generally should be either 6 or 8")}u.digits=h}if(null!=p){if(~~(p=parseInt(p,10))!==p)throw Error("Speakeasy - otpauthURL - Invalid period `"+p+"`");u.period=p}return i.format({protocol:"otpauth",slashes:!0,hostname:n,pathname:r,query:u})}}};