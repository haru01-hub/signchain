"use strict";(()=>{var e={};e.id=7490,e.ids=[7490],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},71175:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>y,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{OPTIONS:()=>l,POST:()=>d});var o=r(49303),a=r(88716),i=r(60670),n=r(87070),p=r(71732),u=r(98691);async function d(e){let{email:t,password:r}=await e.json();if(!t||!r)return n.NextResponse.json({message:"Email and password required"},{status:400});let s=await p.Z.findOne({email:t});if(!s)return n.NextResponse.json({valid:!1},{status:404});let o=await u.ZP.compare(r,s.password);return n.NextResponse.json({valid:o})}async function l(){return n.NextResponse.json({},{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/user/verify-password/route",pathname:"/api/user/verify-password",filename:"route",bundlePath:"app/api/user/verify-password/route"},resolvedPagePath:"E:\\test2\\app\\api\\user\\verify-password\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:m}=c,g="/api/user/verify-password/route";function v(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},71732:(e,t,r)=>{r.d(t,{Z:()=>i});var s=r(11185),o=r.n(s);let a=new s.Schema({username:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},publicKey:{type:String},certificate:{type:String},otpEnabled:{type:Boolean,default:!1},otpSecret:{type:String},otpVerified:{type:Boolean,default:!1},certificateStatus:{type:String,default:"valid"},currentRefreshJti:{type:String}}),i=o().models.User||o().model("User",a)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,8691],()=>r(71175));module.exports=s})();