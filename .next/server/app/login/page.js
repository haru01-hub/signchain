(()=>{var e={};e.id=2626,e.ids=[2626],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},83129:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(94687),r(48395),r(35866);var o=r(23191),n=r(88716),i=r(37922),a=r.n(i),s=r(95231),l={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);r.d(t,l);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,94687)),"E:\\test2\\app\\login\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,48395)),"E:\\test2\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\test2\\app\\login\\page.tsx"],u="/login/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new o.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},19593:(e,t,r)=>{Promise.resolve().then(r.bind(r,185)),Promise.resolve().then(r.bind(r,65572)),Promise.resolve().then(r.bind(r,32779)),Promise.resolve().then(r.bind(r,9536))},25594:(e,t,r)=>{Promise.resolve().then(r.bind(r,1442))},134:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},1442:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var o=r(10326),n=r(17577),i=r(35047),a=r(76865);r(55440);var s=r(40878),l=r(43192);function d(e){return/^[\w-.]+@[\w-]+\.[a-zA-Z]{2,}$/.test(e)}function c(e){return e.length>=8&&/[!@#$%^&*]/.test(e)}let u=()=>{let[e,t]=(0,n.useState)(""),[r,u]=(0,n.useState)(""),[p,x]=(0,n.useState)(""),[f,h]=(0,n.useState)({}),m=(0,i.useRouter)(),[y,g]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),b=d(e)&&c(r),P=async t=>{if(t&&t.preventDefault(),!b){x("입력값을 다시 확인하세요.");return}x(""),g(!0);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),o=await t.json();t.ok?(localStorage.setItem("email",await (0,l.hH)(e)),o.userId&&localStorage.setItem("userId",await (0,l.hH)(o.userId)),o.redirectTo&&(o.redirectTo.startsWith("/otp/verify")?window.location.href=o.redirectTo:x("잘못된 인증 흐름입니다. 다시 시도해 주세요."))):o.message?.includes("인증서가 만료")?w(!0):x(o.message||"로그인 실패")}catch(e){x("서버 오류가 발생했습니다.")}finally{g(!1)}},C=e=>{"Enter"===e.key&&P(e)};return(0,o.jsxs)("div",{className:"card",style:{maxWidth:400,margin:"auto",padding:32},children:[o.jsx("h1",{style:{marginBottom:24},children:"로그인"}),p&&o.jsx("p",{style:{color:"red",marginBottom:16},children:p}),y&&o.jsx(a.Z,{}),(0,o.jsxs)("form",{onSubmit:P,style:{display:"flex",flexDirection:"column",gap:18},children:[o.jsx("input",{type:"email",name:"email",placeholder:"이메일",value:e,onChange:e=>{t(e.target.value),h(e=>({...e,email:!0})),x("")},onKeyDown:C,style:{padding:10,borderRadius:4,marginBottom:6,border:f.email&&!d(e)?"1.5px solid red":"1px solid #ddd"}}),f.email&&!d(e)&&o.jsx("div",{style:{color:"red",fontSize:13,marginBottom:8},children:"이메일 형식이 올바르지 않습니다."}),o.jsx("input",{type:"password",name:"password",placeholder:"비밀번호 (8자 이상, 특수문자 포함)",value:r,onChange:e=>{u(e.target.value),h(e=>({...e,password:!0})),x("")},onKeyDown:C,style:{padding:10,borderRadius:4,marginBottom:6,border:f.password&&!c(r)?"1.5px solid red":"1px solid #ddd"}}),f.password&&!c(r)&&o.jsx("div",{style:{color:"red",fontSize:13,marginBottom:8},children:"비밀번호는 8자 이상, 특수문자 포함이어야 합니다."}),o.jsx("button",{type:"submit",style:{padding:"12px 0",borderRadius:4,backgroundColor:b?"#2483bf":"#b3c6ff",color:"white",border:"none",cursor:b?"pointer":"not-allowed",fontWeight:600,marginTop:16,fontSize:17},disabled:!b,children:"로그인"})]}),(0,o.jsxs)("div",{style:{marginTop:32,color:"#555",fontSize:15,textAlign:"center"},children:["계정이 없으신가요?"," ",o.jsx("a",{href:"/register",style:{color:"#003cff",textDecoration:"underline"},children:"회원가입"})," ","하거나 로그인해주세요."]}),v&&o.jsx(s.Z,{message:"인증서가 만료되었습니다. 재발급이 필요합니다.",onConfirm:()=>{w(!1),m.push("/register")},onCancel:()=>{w(!1),m.push("/register")},confirmLabel:"확인",cancelLabel:"닫기"})]})}},40878:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var o=r(10326);function n({message:e,onConfirm:t,onCancel:r,integrityMsg:n="",children:i,confirmLabel:a="확인",cancelLabel:s="취소"}){return o.jsx("div",{className:"confirm-modal-backdrop",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:10,padding:32,minWidth:320,boxShadow:"0 2px 16px #0003"},onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{style:{marginBottom:18},children:[o.jsx("b",{children:e}),i]}),o.jsx("div",{style:{display:"flex",gap:12,marginBottom:10,justifyContent:"center"},children:o.jsx("button",{onClick:t,style:{background:"#1976d2",color:"#fff",border:"none",borderRadius:6,padding:"8px 18px",fontWeight:500},children:a})}),n&&o.jsx("div",{style:{color:n.includes("완료")?"green":"red",fontWeight:600},children:n})]})})}r(17577)},185:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var o=r(10326),n=r(35047),i=r(17577),a=r(76865);function s(){let e=(0,n.usePathname)(),[t,r]=(0,i.useState)(!1);return(0,i.useRef)(e),t?o.jsx(a.Z,{}):null}r(55440)},76865:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var o=r(10326);r(17577),r(55440);let n=()=>o.jsx("div",{className:"spinner-overlay",children:o.jsx("div",{className:"spinner"})})},65572:(e,t,r)=>{"use strict";r.d(t,{ContractProvider:()=>a,z:()=>s});var o=r(10326),n=r(17577);let i=(0,n.createContext)(void 0);function a({children:e}){let[t,r]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),l=(0,n.useCallback)(async()=>{s(!0);try{let e=await fetch("/api/contract",{credentials:"include"});if(!e.ok)throw Error("API error");let t=await e.json();r(t||[])}catch{r([])}finally{s(!1)}},[]);return o.jsx(i.Provider,{value:{contracts:t,loading:a,refreshContracts:l},children:e})}function s(){let e=(0,n.useContext)(i);if(!e)throw Error("useContractContext must be used within a ContractProvider");return e}},32779:(e,t,r)=>{"use strict";r.d(t,{NotificationProvider:()=>a,n:()=>s});var o=r(10326),n=r(17577);let i=(0,n.createContext)(void 0);function a({children:e}){let[t,r]=(0,n.useState)([]),[a,s]=(0,n.useState)(0),[l,d]=(0,n.useState)(!0),c=(0,n.useCallback)(async()=>{d(!0);try{let e=await fetch("/api/auth/notifications",{credentials:"include"});if(!e.ok)throw Error("API error");let t=await e.json();r(t.notifications||[]),s((t.notifications||[]).filter(e=>!e.read).length)}catch{r([]),s(0)}finally{d(!1)}},[]);return o.jsx(i.Provider,{value:{notifications:t,unreadCount:a,loading:l,refreshNotifications:c},children:e})}function s(){let e=(0,n.useContext)(i);if(!e)throw Error("useNotificationContext must be used within a NotificationProvider");return e}},9536:(e,t,r)=>{"use strict";r.d(t,{UserProvider:()=>a});var o=r(10326),n=r(17577);let i=(0,n.createContext)(void 0);function a({children:e}){let[t,r]=(0,n.useState)(null),a=async()=>{try{let e=await fetch("/api/user/me");if(!e.ok)throw Error("API error");let t=await e.json();r(t)}catch{r(null)}};return o.jsx(i.Provider,{value:{user:t,setUser:r,refreshUser:a},children:e})}},43192:(e,t,r)=>{"use strict";let o;async function n(e,t){let r=new TextEncoder,o=await window.crypto.subtle.importKey("raw",r.encode(e),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r.encode(t),iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function i(e,t){if(!window.crypto?.subtle)throw Error("이 브라우저는 WebCrypto를 지원하지 않습니다.");let r=new TextEncoder,o=window.crypto.getRandomValues(new Uint8Array(12)),n=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},t,r.encode(e));return{iv:btoa(String.fromCharCode(...o)),data:btoa(String.fromCharCode(...new Uint8Array(n)))}}async function a(e,t){if(!window.crypto?.subtle)throw Error("이 브라우저는 WebCrypto를 지원하지 않습니다.");let r=new TextDecoder,o=Uint8Array.from(atob(e.iv),e=>e.charCodeAt(0)),n=Uint8Array.from(atob(e.data),e=>e.charCodeAt(0)),i=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},t,n);return r.decode(i)}function s(e){if(!o)throw Error("Node.js crypto not available");let t=Buffer.from(process.env.EMAIL_AES_KEY,"hex"),[r,n]=e.split(":"),i=Buffer.from(r,"hex"),a=o.createDecipheriv("aes-256-cbc",t,i);return a.update(n,"hex","utf8")+a.final("utf8")}async function l(){return n("5012145a3c04312f81ce8b38c90d875f7de96b868f94f451cd6d6709a92d7c23","38f74cb399659a9016a080d65395986f")}async function d(e){let t=await l(),{iv:r,data:o}=await i(e,t);return JSON.stringify({iv:r,data:o})}async function c(e){try{console.log("[decryptLocal] 입력값:",e);let t=await l(),r=JSON.parse(e);console.log("[decryptLocal] 파싱된 iv:",r.iv),console.log("[decryptLocal] 파싱된 data:",r.data);let o=await a({iv:r.iv,data:r.data},t);return console.log("[decryptLocal] 복호화 결과:",o),o}catch(e){throw console.error("[decryptLocal] 복호화 중 에러:",e),e}}r.d(t,{LJ:()=>s,bd:()=>n,hH:()=>d,jz:()=>a,oj:()=>i,vm:()=>c}),o=r(84770)},48395:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,dynamic:()=>d,metadata:()=>c});var o=r(19510);r(67272);var n=r(68570);let i=(0,n.createProxy)(String.raw`E:\test2\contexts\NotificationContext.tsx#NotificationProvider`);(0,n.createProxy)(String.raw`E:\test2\contexts\NotificationContext.tsx#useNotificationContext`);let a=(0,n.createProxy)(String.raw`E:\test2\contexts\ContractContext.tsx#ContractProvider`);(0,n.createProxy)(String.raw`E:\test2\contexts\ContractContext.tsx#useContractContext`);let s=(0,n.createProxy)(String.raw`E:\test2\components\GlobalLoading.tsx#default`),l=(0,n.createProxy)(String.raw`E:\test2\contexts\UserContext.tsx#UserProvider`);(0,n.createProxy)(String.raw`E:\test2\contexts\UserContext.tsx#useUserContext`);let d="force-dynamic",c={title:"SignChain",description:"전자서명/계약 서비스"};function u({children:e}){return o.jsx("html",{lang:"en",children:o.jsx("body",{className:"antialiased",children:o.jsx(l,{children:o.jsx(i,{children:(0,o.jsxs)(a,{children:[o.jsx(s,{}),e]})})})})})}},94687:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});let o=(0,r(68570).createProxy)(String.raw`E:\test2\app\login\page.tsx#default`)},67272:()=>{},55440:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,2772],()=>r(83129));module.exports=o})();